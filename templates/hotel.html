{% extends "base.html" %}
{% block title %}Hotel Dashboard ‚Äî FoodBridge{% endblock %}

{% block content %}
<div class="dashboard-wrapper">
    <aside class="sidebar">
        <div class="sidebar-profile">
            <div class="profile-avatar">üè®</div>
            <div>
                <p class="profile-name">{{ session.get('name', 'Hotel Partner') }}</p>
                <p class="profile-type">Hotel / Restaurant</p>
            </div>
        </div>
        <nav class="sidebar-nav">
            <a href="#post" class="sidebar-link active">üì§ Post Surplus</a>
            <a href="#history" class="sidebar-link">üìã My Listings</a>
            <a href="#impact" class="sidebar-link">üåü My Impact</a>
            <a href="#claimed" class="sidebar-link">‚úÖ Claimed Food</a>
        </nav>
        <a href="/logout" class="sidebar-logout">‚Üê Logout</a>
    </aside>

    <main class="dashboard-main">
        <div class="dash-header">
            <h1>Good to see you! <span class="accent">Let's share some food.</span></h1>
            <p>Every listing you post can feed dozens of people today.</p>
        </div>

        <!-- Post Surplus Food Form -->
        <section class="dash-section" id="post">
            <div class="section-card">
                <h2 class="card-heading">üì§ Post Surplus Food</h2>
                <form method="POST" action="/hotel/post-food" class="food-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label>Food Name / Description</label>
                            <input type="text" name="food_name" placeholder="e.g. Veg Biryani, Paneer Curry, Mixed Salad" required>
                        </div>
                        <div class="form-group">
                            <label>Food Category</label>
                            <select name="category" required>
                                <option value="">Select category</option>
                                <option>Rice & Biryani</option>
                                <option>Bread & Rotis</option>
                                <option>Curries & Gravies</option>
                                <option>Snacks & Starters</option>
                                <option>Desserts</option>
                                <option>Beverages</option>
                                <option>Salads & Sides</option>
                                <option>Packaged / Sealed Food</option>
                                <option>Other</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Quantity Available</label>
                            <input type="number" name="quantity" placeholder="e.g. 40" min="1" required>
                        </div>
                        <div class="form-group">
                            <label>Quantity Unit</label>
                            <select name="unit" required>
                                <option value="">Select unit</option>
                                <option>Portions / Plates</option>
                                <option>Kilograms (kg)</option>
                                <option>Litres (L)</option>
                                <option>Packets</option>
                                <option>Boxes</option>
                                <option>Trays</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Prepared At (Time)</label>
                            <input type="time" name="prepared_at" required>
                        </div>
                        <div class="form-group">
                            <label>Best Before (Time ‚Äî stays fresh until)</label>
                            <input type="time" name="best_before" required>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Food Type</label>
                            <div class="radio-group">
                                <label class="radio-label"><input type="radio" name="food_type" value="veg" checked> üü¢ Vegetarian</label>
                                <label class="radio-label"><input type="radio" name="food_type" value="nonveg"> üî¥ Non-Vegetarian</label>
                                <label class="radio-label"><input type="radio" name="food_type" value="vegan"> üåø Vegan</label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Contains Allergens?</label>
                            <div class="checkbox-group">
                                <label class="check-label"><input type="checkbox" name="allergens" value="nuts"> Nuts</label>
                                <label class="check-label"><input type="checkbox" name="allergens" value="dairy"> Dairy</label>
                                <label class="check-label"><input type="checkbox" name="allergens" value="gluten"> Gluten</label>
                                <label class="check-label"><input type="checkbox" name="allergens" value="eggs"> Eggs</label>
                            </div>
                        </div>
                    </div>

                    <div class="form-group full-width">
                        <label>Pickup Address</label>
                        <input type="text" name="pickup_address" placeholder="Full address for NGO pickup" required>
                    </div>

                    <div class="form-group full-width">
                        <label>Special Instructions (optional)</label>
                        <textarea name="instructions" placeholder="e.g. Please bring your own containers, call before arrival, food is packed in trays..." rows="3"></textarea>
                    </div>

                    <div class="form-group full-width">
                        <label>Contact Person & Phone</label>
                        <div class="form-row">
                            <input type="text" name="contact_name" placeholder="Contact name">
                            <input type="tel" name="contact_phone" placeholder="Phone number">
                        </div>
                    </div>

                    <button type="submit" class="btn btn-primary btn-large">üöÄ Post Surplus Food</button>
                </form>
            </div>
        </section>

        <!-- Active Listings -->
        <section class="dash-section" id="history">
            <div class="section-card">
                <h2 class="card-heading">üìã Active Listings</h2>
                {% if listings %}
                    <div class="listings-grid">
                        {% for item in listings %}
                        <div class="listing-card {{ 'claimed' if item.claimed else 'available' }}">
                            <div class="listing-top">
                                <span class="listing-name">{{ item.food_name }}</span>
                                <span class="listing-badge {{ 'badge-claimed' if item.claimed else 'badge-available' }}">
                                    {{ '‚úÖ Claimed' if item.claimed else 'üü¢ Available' }}
                                </span>
                            </div>
                            <p class="listing-detail">{{ item.quantity }} {{ item.unit }} ¬∑ {{ item.category }}</p>
                            <p class="listing-time">Best before: {{ item.best_before }}</p>
                        </div>
                        {% endfor %}
                    </div>
                {% else %}
                    <div class="empty-state">
                        <p>üçΩÔ∏è No active listings yet. Post your first surplus food above!</p>
                    </div>
                {% endif %}
            </div>
        </section>

        <!-- Impact Stats -->
        <section class="dash-section" id="impact">
            <div class="section-card">
                <h2 class="card-heading">üåü Your Impact</h2>
                <div class="impact-grid">
                    <div class="impact-card">
                        <span class="impact-num">{{ impact.meals_shared or 0 }}</span>
                        <span class="impact-label">Meals Shared</span>
                    </div>
                    <div class="impact-card">
                        <span class="impact-num">{{ impact.kg_saved or 0 }} kg</span>
                        <span class="impact-label">Food Saved</span>
                    </div>
                    <div class="impact-card">
                        <span class="impact-num">{{ impact.ngos_helped or 0 }}</span>
                        <span class="impact-label">NGOs Helped</span>
                    </div>
                    <div class="impact-card">
                        <span class="impact-num">{{ impact.co2_saved or 0 }} kg</span>
                        <span class="impact-label">CO‚ÇÇ Avoided</span>
                    </div>
                </div>
            </div>
        </section>
        <!-- Claimed Food Section -->
<section class="dash-section" id="claimed">
    <div class="section-card">
        <h2 class="card-heading">‚úÖ Claimed Food</h2>
        {% if listings %}
            <div class="listings-grid">
                {% for item in listings if item['is_claimed'] %}
                <div class="listing-card claimed">
                    <div class="listing-top">
                        <span class="listing-name">{{ item['food_name'] }}</span>
                        <span class="listing-badge badge-claimed">‚úÖ Claimed</span>
                    </div>
                    <p class="listing-detail">{{ item['quantity'] }} {{ item['unit'] }} ¬∑ {{ item['category'] }}</p>
                    <p class="listing-time">Best before: {{ item['best_before'] }}</p>
                    <p class="listing-time" style="margin-top:6px; color: var(--green);">
                        ü§ù Picked up by an NGO
                    </p>
                </div>
                {% else %}
                <div class="empty-state">
                    <p>üçΩÔ∏è None of your listings have been claimed yet.</p>
                </div>
                {% endfor %}
            </div>
        {% else %}
            <div class="empty-state">
                <p>üçΩÔ∏è No claimed food yet. Post surplus food to get started!</p>
            </div>
        {% endif %}
    </div>
</section>
    </main>
</div>
{% endblock %}